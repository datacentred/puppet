---
classes:
  - '::dc_profile::openstack::neutron::agent_network'
  - '::dc_icinga::hostgroup_neutron_node'

neutron::agents::ml2::ovs::bridge_uplinks:
 - "br-ex:em2"
 - "br-p2p2:p2p2"
neutron::agents::ml2::ovs::bridge_mappings:
 - 'default:br-ex'
 - 'as201541:br-p2p2'
neutron::agents::l3::external_network_bridge: ''
neutron::agents::l3::gateway_external_network_id: ''

neutron::debug: true

sudo::configs:
  neutron:
    content: |
      Defaults:neutron !requiretty, syslog_badpri=err, syslog_goodpri=info
      neutron ALL=(root) NOPASSWD: /usr/bin/neutron-rootwrap

dc_nrpe::checks::common::check_procs:
  warn: 800
  crit: 1000

sysctls::values:
    fs.file-max:
        value: '4096000'
    net.core.rmem_max:
        value: '67108864'
    net.core.wmem_max:
        value: '67108864'
    net.core.rmem_default:
        value: '33554432'
    net.core.wmem_default:
        value: '33554432'
    net.ipv4.tcp_rmem:
        value: '16384 87380 6291456'
    net.ipv4.tcp_wmem:
        value: '16384 32768 4194304'
    net.ipv4.udp_rmem_min:
        value: '16384'
    net.ipv4.udp_wmem_min:
        value: '16384'
    net.core.optmem_max:
        value: '65536'
    net.ipv4.tcp_low_latency:
        value: '1'
    net.ipv4.tcp_window_scaling:
        value: '1'
    net.ipv4.tcp_slow_start_after_idle:
        value: '0'
    net.ipv4.tcp_no_metrics_save:
        value: '1'
    net.ipv4.tcp_sack:
        value: '0'
    net.core.somaxconn:
        value: '8192'
    net.ipv4.tcp_max_syn_backlog:
        value: '8192'
    net.ipv4.tcp_syncookies:
        value: '1'
    net.core.netdev_max_backlog:
        value: '32768'
    net.ipv4.tcp_fin_timeout:
        value: '15'
    net.ipv4.tcp_max_tw_buckets:
        value: '131072'
    net.ipv4.tcp_tw_reuse:
        value: '1'
    net.ipv4.tcp_timestamps:
        value: '1'
    net.ipv4.tcp_keepalive_time:
        value: '120'
    net.ipv4.tcp_keepalive_intvl:
        value: '30'
    net.ipv4.tcp_keepalive_probes:
        value: '3'
    net.ipv4.ip_local_port_range:
        value: '16384 65000'
    net.nf_conntrack_max:
        value: '262144'
    vm.swappiness:
        value: '10'

dc_nrpe::checks::neutron_routers::username: "%{hiera('keystone_icinga_user')}"
dc_nrpe::checks::neutron_routers::password: "%{hiera('keystone_icinga_password')}"
dc_nrpe::checks::neutron_routers::tenant_name: "%{hiera('keystone_icinga_tenant')}"
dc_nrpe::checks::neutron_routers::auth_url: "https://%{hiera('os_api_host')}:35357/v2.0/"
